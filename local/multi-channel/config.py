# -*- coding: utf-8 -*-


configs_SC_Multiple_4Speakers_ivectors_2Classes = {"input_dim": 40,
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, 1]], 
"speaker_embedding_dim": 100,
"splice_size": 20*128+100,
"Linear_dim": 384,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 4
}

configs_2Speakers_ivector_ivector128_2Classes = {"input_dim": 40,
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, 1]],
"fea_dim": 20*128,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"splice_size": 20*128+100+100,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 2
}

configs_4Speakers_ivector_ivector128_2Classes = {"input_dim": 40,
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, 1]],
"fea_dim": 20*128,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"splice_size": 20*128+100+100,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 4
}

configs_4Speakers_ivector_ivector128_2Classes_tsep = {"input_dim": 641,
"average_pooling": 151,
"cnn_configs": [[2, 32, 3, 1], [32, 32, 3, 1], [32, 64, 3, (2, 1)], [64, 64, 3, 1]],
"fea_dim": 321*64,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"splice_size": 321*64+100+100,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 4
}

configs_4Speakers_fbank80_ivector_ivector128_2Classes = {"input_dim": 80,
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, (2, 1)]],
"fea_dim": 20*128,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"splice_size": 20*128+100+100,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 4
}

configs_4Speakers_ecapa_tdnn_ivector_ivector128_2Classes = {
"ECAPA_TDNN_pretrain_path": "exp/ECAPA-TDNN/embedding_model.ckpt",
"ECAPA_TDNN_fixed": False,
"fea_dim": 3072,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"splice_size": 3072+100+100,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 4
}

configs_4Speakers_ecapa_fixed_tdnn_ivector_ivector128_2Classes = {
"ECAPA_TDNN_pretrain_path": "exp/ECAPA-TDNN/embedding_model.ckpt",
"ECAPA_TDNN_fixed": True,
"fea_dim": 3072,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"splice_size": 3072+100+100,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 4
}

configs_2Speakers_ivector_ivector128_xvectors128_2Classes = {"input_dim": 40,
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, 1]],
"fea_dim": 20*128,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"n_heads2": 8,
"embedding_path2": "embedding_raw/voxceleb/xvector_cluster_center_128.npy",
"splice_size": 20*128+100+100+256,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 2
}

configs3_4Speakers_ivector_ivector128_xvectors128_2Classes = {"input_dim": 40,
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, 1]],
"fea_dim": 20*128,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"n_heads2": 8,
"embedding_path2": "embedding_raw/voxceleb/xvector_cluster_center_128.npy",
"splice_size": 20*128+100+100+256,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 4
}

configs_ca_ivector128_2Classes = {"input_dim": 40,
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, 1]],
"fea_dim": 20*128,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"n_heads2": 8,
"embedding_path2": "embedding_raw/voxceleb/xvector_cluster_center_128.npy",
"splice_size": 20*128+100,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 4
}

configs_4Speakers_ivector_ivector128_xvectors128_ecapaxvectors128_2Classes = {"input_dim": 40,
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, 1]],
"fea_dim": 20*128,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"n_heads2": 8,
"embedding_path2": "embedding_raw/voxceleb/xvector_cluster_center_128.npy",
"n_heads3": 8,
"embedding_path3": "embedding_raw/voxceleb/xvector_ecapa_tdnn_cluster_center_128.npy",
"splice_size": 20*128+100+100+256+192,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 4
}

configs_4Speakers_wavlm_mamse = {"input_dim": 1024,
"wavlm_pt": "exp/WavLM/wavlm_large.pt",
"average_pooling": 151,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, 1]],
"fea_dim": 1024,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"n_heads2": 8,
"embedding_path2": "embedding_raw/voxceleb/xvector_cluster_center_128.npy",
"splice_size": 1024+100+100+256,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 4
}

configs_4Speakers_fbank_wavlm_mamse = {
"wavlm_pt": "exp/WavLM/wavlm_large.pt",
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 2)], [128, 128, 3, 1]],
"fea_dim": 1024*2,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"n_heads2": 8,
"embedding_path2": "embedding_raw/voxceleb/xvector_cluster_center_128.npy",
"splice_size": 1024+1024+100+100,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 4
}

configs_mc_4Speakers_ivector_ivector128_xvectors128_2Classes = {"input_dim": 40,
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, 1]],
"fea_dim": 20*128,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"n_heads2": 8,
"embedding_path2": "embedding_raw/voxceleb/xvector_cluster_center_128.npy",
"splice_size": 20*128+100+100+256,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"n_head": 8,
"dropout": 0.1,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 4
}

configs_mc_ca_4Speakers = {"input_dim": 40,
"wavlm_pt": "exp/WavLM/wavlm_large.pt",
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, 1]],
"fea_dim": 20*128,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"n_heads2": 8,
"embedding_path2": "embedding_raw/voxceleb/xvector_cluster_center_128.npy",
"splice_size": 20*128+100+100+256,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"n_head": 8,
"dropout": 0.0,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 4
}

configs_mc_ca_2Speakers = {"input_dim": 40,
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, 1]],
"fea_dim": 20*128,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"n_heads2": 8,
"embedding_path2": "embedding_raw/voxceleb/xvector_cluster_center_128.npy",
"splice_size": 20*128+100+100+256,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"n_head": 8,
"dropout": 0.0,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 2
}

configs_mc_ca_conformer_2Speakers = {"input_dim": 40,
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, 1]],
"fea_dim": 20*128,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"n_heads2": 8,
"embedding_path2": "embedding_raw/voxceleb/xvector_cluster_center_128.npy",
"splice_size": 20*128+100+100+256,
"share_conformer": {"dim":512, "dim_head":64, "heads":8, "ff_mult":4, "conv_expansion_factor":2, "conv_kernel_size":31, "attn_dropout":0., "ff_dropout":0., "conv_dropout":0.},
"share_conformer_layers": 4,
"conformer": {"dim":512, "dim_head":64, "heads":8, "ff_mult":4, "conv_expansion_factor":2, "conv_kernel_size":31, "attn_dropout":0., "ff_dropout":0., "conv_dropout":0.},
"conformer_layers": 2,
"n_head": 8,
"dropout": 0.0,
"output_speaker": 2
}

configs2_mc_ca_conformer_2Speakers = {"input_dim": 40,
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, 1]],
"fea_dim": 20*128,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"n_heads2": 8,
"embedding_path2": "embedding_raw/voxceleb/xvector_cluster_center_128.npy",
"splice_size": 20*128+100+100+256,
"share_conformer": {"dim":512, "dim_head":64, "heads":8, "ff_mult":4, "conv_expansion_factor":2, "conv_kernel_size":31, "attn_dropout":0.2, "ff_dropout":0.2, "conv_dropout":0.2},
"share_conformer_layers": 4,
"conformer": {"dim":512, "dim_head":64, "heads":8, "ff_mult":4, "conv_expansion_factor":2, "conv_kernel_size":31, "attn_dropout":0.2, "ff_dropout":0.2, "conv_dropout":0.2},
"conformer_layers": 2,
"n_head": 8,
"dropout": 0.0,
"output_speaker": 2
}

configs_mc_wavlm_ca_4Speakers = {
"wavlm_pt": "exp/WavLM/wavlm_large.pt",
"fea_dim":1024,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"n_heads2": 8,
"embedding_path2": "embedding_raw/voxceleb/xvector_cluster_center_128.npy",
"splice_size": 1024+100+100+256,
"Linear_dim": 896,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"n_head": 8,
"dropout": 0.0,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 4
}

configs_mc_cov_4Speakers_ivector_ivector128_xvectors128_2Classes = {"input_dim": 40,
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, 1]],
"fea_dim": 20*128,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"n_heads2": 8,
"embedding_path2": "embedding_raw/voxceleb/xvector_cluster_center_128.npy",
"splice_size": 20*128+100+100+256,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"cnn_attention": [320, 320, 3, 1],
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 4
}

configs_8Speakers_ivector_ivector128_xvectors128_2Classes = {"input_dim": 40,
"average_pooling": 301,
"cnn_configs": [[2, 64, 3, 1], [64, 64, 3, 1], [64, 128, 3, (2, 1)], [128, 128, 3, 1]],
"fea_dim": 20*128,
"n_heads1": 8,
"embedding_path1": "embedding_raw/voxceleb/cluster_center_128.npy",
"n_heads2": 8,
"embedding_path2": "embedding_raw/voxceleb/xvector_cluster_center_128.npy",
"splice_size": 20*128+100+100+256,
"Linear_dim": 896*2,
"Shared_BLSTM_dim": 896,
"Linear_Shared_layer1_dim": 160,
"Linear_Shared_layer2_dim": 160,
"BLSTM_dim": 896,
"BLSTM_Projection_dim": 160,
"output_dim": 2,
"output_speaker": 8
}



configs = {
    "configs_SC_Multiple_4Speakers_ivectors_2Classes": configs_SC_Multiple_4Speakers_ivectors_2Classes,
    "configs3_4Speakers_ivector_ivector128_xvectors128_2Classes": configs3_4Speakers_ivector_ivector128_xvectors128_2Classes,
    "configs_4Speakers_ivector_ivector128_xvectors128_ecapaxvectors128_2Classes": configs_4Speakers_ivector_ivector128_xvectors128_ecapaxvectors128_2Classes,
    "configs_mc_4Speakers_ivector_ivector128_xvectors128_2Classes": configs_mc_4Speakers_ivector_ivector128_xvectors128_2Classes,
    "configs_mc_cov_4Speakers_ivector_ivector128_xvectors128_2Classes": configs_mc_cov_4Speakers_ivector_ivector128_xvectors128_2Classes,
    "configs_8Speakers_ivector_ivector128_xvectors128_2Classes": configs_8Speakers_ivector_ivector128_xvectors128_2Classes,
    "configs_4Speakers_wavlm_mamse": configs_4Speakers_wavlm_mamse,
    "configs_mc_ca_4Speakers": configs_mc_ca_4Speakers,
    "configs_mc_wavlm_ca_4Speakers": configs_mc_wavlm_ca_4Speakers,
    "configs_4Speakers_fbank_wavlm_mamse": configs_4Speakers_fbank_wavlm_mamse,
    "configs_4Speakers_ivector_ivector128_2Classes": configs_4Speakers_ivector_ivector128_2Classes,
    "configs_4Speakers_ecapa_tdnn_ivector_ivector128_2Classes": configs_4Speakers_ecapa_tdnn_ivector_ivector128_2Classes,
    "configs_ca_ivector128_2Classes": configs_ca_ivector128_2Classes,
    "configs_4Speakers_fbank80_ivector_ivector128_2Classes": configs_4Speakers_fbank80_ivector_ivector128_2Classes,
    "configs_4Speakers_ecapa_fixed_tdnn_ivector_ivector128_2Classes": configs_4Speakers_ecapa_fixed_tdnn_ivector_ivector128_2Classes,
    "configs_2Speakers_ivector_ivector128_2Classes": configs_2Speakers_ivector_ivector128_2Classes,
    "configs_2Speakers_ivector_ivector128_xvectors128_2Classes": configs_2Speakers_ivector_ivector128_xvectors128_2Classes,
    "configs_mc_ca_2Speakers": configs_mc_ca_2Speakers,
    "configs_4Speakers_ivector_ivector128_2Classes_tsep": configs_4Speakers_ivector_ivector128_2Classes_tsep,
    "configs_mc_ca_conformer_2Speakers": configs_mc_ca_conformer_2Speakers,
    "configs2_mc_ca_conformer_2Speakers": configs2_mc_ca_conformer_2Speakers
}